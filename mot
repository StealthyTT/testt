blueprint:
  name: Motion-Based Light Control with Toggle, Zone, and Reset
  description: |
    Turns on the light when motion is detected in a specified zone, disables the automation if the light is toggled off and on within a short time, 
    and re-enables it if the light has been off for 5 minutes.
  domain: automation
  input:
    motion_sensor:
      name: Motion Sensor
      description: The motion sensor to detect motion.
      selector:
        entity:
          domain: binary_sensor
          device_class: motion
    light_entity:
      name: Light
      description: The light to control.
      selector:
        entity:
          domain: light
    toggle_count_helper:
      name: Toggle Count Helper
      description: The helper to count how many times the light has been toggled.
      selector:
        entity:
          domain: input_number
    automation_enabled_helper:
      name: Automation Enabled Helper
      description: The helper to enable or disable the automation.
      selector:
        entity:
          domain: input_boolean
    reset_timer:
      name: Reset Timer
      description: Timer to reset toggle count after inactivity.
      selector:
        entity:
          domain: timer
    light_off_timer:
      name: Light Off Timer
      description: Timer to track if the light has been off for 5 minutes.
      selector:
        entity:
          domain: timer
    motion_zone:
      name: Motion Zone
      description: The zone where motion must be detected.
      selector:
        entity:
          domain: zone

trigger:
  - platform: state
    entity_id: !input 'motion_sensor'
    to: "on"
  - platform: state
    entity_id: !input 'motion_zone'
    to: "on"

condition:
  - condition: state
    entity_id: !input 'automation_enabled_helper'
    state: "on"  # Only proceed if automation is enabled
  - condition: zone
    entity_id: !input 'motion_sensor'
    
